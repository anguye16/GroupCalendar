<!-- This page will allow users to login and view other pages that are locked behind a login wall -->

<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
    <title>Login</title>
    <link rel="stylesheet" href="webStyles.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/3.4.0/firebase.js"></script>
</head>

<header>
    <a href="index"> <img class="logo" src="grouplogo.png" alt="GroupCalendarLogo" height="200" width="200"></a>
    <ul>
        <li><a href="login">login</a></li>
        <li><a href="signup">sign up</a></li>
        <li><a href="about">about us</a></li>
    </ul>
</header>

<body>
<h1>
    Login
</h1>

<input type="text" name="email" placeholder="Email" pattern=".+@.+\.com"><br>
<input type="password" name="password" placeholder="Password" pattern=".+"><br>

<p>
    <select>
        <ul class="tabs">
            <option>Student</option>
            <option>Teacher</option>
        </ul>
    </select>
</p>

<button id="submitButton" class="round">Submit</button>

<p id="incorrect" style="color:red">Incorrect email/password credentials.</p>
<p id="correct" style="color:green">You are now logged in.</p>

<section></section>

<script>
    $('#incorrect').hide();
    $('#correct').hide();

    // Initialize Firebase
    var config = {
        apiKey: "AIzaSyC-qT42afFTH5hPZ_v9wvbrV0sLEggRjHc",
        authDomain: "groupcalendar-82b96.firebaseapp.com",
        databaseURL: "https://groupcalendar-82b96.firebaseio.com",
        storageBucket: "groupcalendar-82b96.appspot.com",
        messagingSenderId: "519544706410"
    };
    firebase.initializeApp(config);

    // Firebase scripts
    var accountRef = firebase.database().ref('accounts');


    $('#submitButton').click(function() {
        accountRef.orderByChild("Email").on("child_added", function(snapshot){ // Searches through all emails
            if(snapshot.val().Email == $('[name=email]').val()){ // Email is matched
                accountRef.orderByChild("Password").on("child_added", function(snapshot){ // Searches through all passwords
                    if(snapshot.val().Password == $('[name=password]').val()){ // Password is found WITH correct Email
                        $('#incorrect').hide();
                        $('#correct').show();
                    }
                    else{
                        $('#correct').hide();
                        $('#incorrect').show();
                    }
                });
            }
            else{
                $('#correct').hide();
                $('#incorrect').show();
            }
        });
    });


</script>


</body>
<footer>
	<ul>
		<li><a href="about">about us</a></li>
	</ul>
</footer>
</html>
